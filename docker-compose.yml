services:
  homepi:
    image: ghcr.io/yavgenyp/homepi:latest
    build: .   # ignored when pulling the prebuilt image; used by `docker compose up --build`
    restart: unless-stopped
    env_file: .env
    ports:
      - "3000:3000"
    volumes:
      - homepi-data:/data
    # --- TTS audio playback (Raspberry Pi only) ---
    # Uncomment the lines below when TTS_ENABLED=true.
    # Gives the container access to the Pi's ALSA sound system.
    #
    # devices:
    #   - /dev/snd:/dev/snd
    # group_add:
    #   - audio

    # --- BLE support (Raspberry Pi only) ---
    # Uncomment the lines below when PRESENCE_BLE_ENABLED=true.
    # Requires BlueZ installed on the host: sudo apt install bluez
    #
    # network_mode: host
    # volumes:
    #   - homepi-data:/data
    #   - /run/dbus:/run/dbus:ro
    # cap_add:
    #   - NET_ADMIN
    #   - SYS_ADMIN
    # devices:
    #   - /dev/ttyAMA0   # only needed for UART Bluetooth adapters

volumes:
  homepi-data:
